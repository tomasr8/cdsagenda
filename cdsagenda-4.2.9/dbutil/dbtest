#!/usr/bin/php
<?
## $Id: dbtest.in,v 1.1.1.1.4.2 2002/10/23 08:56:21 tbaron Exp $
## Tests php/db connectivity.  Called while "make".

## This file is part of CDS Agenda..
## Copyright (C) 2002 CERN.
##
## The CDS Agenda Software is free software; you can redistribute it and/or
## modify it under the terms of the GNU General Public License as
## published by the Free Software Foundation; either version 2 of the
## License, or (at your option) any later version.
##
## The CDS Agenda Software is distributed in the hope that it will be useful,
## but WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
## General Public License for more details.  
##
## You should have received a copy of the GNU General Public License
## along with CDS Agenda Software; if not, write to the Free Software
## Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.

## DO NOT EDIT THIS FILE!  IT WAS AUTOMATICALLY GENERATED FROM CDS Agenda SOURCES.

require_once("../htdocs/AgeDB.php");

## try to connect to the DB server and select the database:
$db = &AgeDB::getDB();
if (!$db) {
	print "
    ********************************************************
    ** Database connectivity error:                       **
    ** You probably don't have proper DB user credentials.**
    ** You need to fix this error before continuing!      **
    ********************************************************";
	exit;
}

## execute test query:
$res = $db->query("SELECT * from LEVEL");
if (!$res) {
	print "
    *************************************************
    ** Database query error:                       **
    ** Perhaps you need to create CDS Age tables?  **
    ** If yes, then run 'make create-tables' now.  **
    ** If not, then read the above error message   **
    **   and fix the problem before continuing!    **
    *************************************************\n";
	exit;
}

/*
## fill config variables:
$dbhost = "localhost";
$dbname = "cdsagenda";
$dbuser = "root";
$dbpass = "pass";

## try to connect to the DB server:
if (!mysql_connect($dbhost,$dbuser,$dbpass)) {
	print "Database connectivity error: " . mysql_error() . "\n" .
	      "You probably don't have proper MySQL user credentials.\n" .
	      "You need to fix this error before continuing!";
	exit;
}

## execute select test
if (!mysql_select_db($dbname)) {
	print "
    *************************************************
    ** Database query error: " . mysql_error() . "
    ** Cannot select CDS Agenda database           **
    **   Please fix the problem before continuing! **
    *************************************************\n";
	exit;
}

## execute test query:
if (!mysql_query("select * from LEVEL")) {
	print "
    *************************************************
    ** Database query error: " . mysql_error() . "
    ** Perhaps you need to create CDS Age tables?  **
    ** If yes, then run 'make create-tables' now.  **
    ** If not, then read the above error message   **
    **   and fix the problem before continuing!    **
    *************************************************\n";
	exit;
}

mysql_close();
*/
?>
